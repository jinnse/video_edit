<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>CBT ë¬¸ì œ í’€ê¸°</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      max-width: 800px;
      margin: auto;
      padding: 2rem;
    }
    .question {
      margin-bottom: 2rem;
    }
    .choice {
      margin-left: 1rem;
    }
    .button-bar {
      margin: 1.5rem 0;
      display: flex;
      gap: 1rem;
    }
    .button-bar button {
      padding: 0.5rem 1rem;
      font-size: 1rem;
      cursor: pointer;
    }
    #result {
      margin-top: 1.5rem;
      font-weight: bold;
      font-size: 1.2rem;
    }
  </style>
</head>
<body>
  <h1>ğŸ“ ëœë¤ CBT (ì „ì²´ ë¬¸ì œ ë³´ê¸°)</h1>

  <!-- ìƒë‹¨ ë²„íŠ¼ -->
  <div class="button-bar">
    <button onclick="shuffleAndRender()">ë¬¸ì œ ì„ê¸°</button>
    <button onclick="grade()">ì±„ì í•˜ê¸°</button>
  </div>

  <!-- ë¬¸ì œ í‘œì‹œ ì˜ì—­ -->
  <div id="quiz"></div>

  <!-- í•˜ë‹¨ ë²„íŠ¼ -->
  <div class="button-bar">
    <button onclick="shuffleAndRender()">ë¬¸ì œ ì„ê¸°</button>
    <button onclick="grade()">ì±„ì í•˜ê¸°</button>
  </div>

  <!-- ì±„ì  ê²°ê³¼ -->
  <div id="result"></div>

  <script>
    const originalQuestions = [
      {
        question: "ë‹¤ìŒ ì¤‘ ëŒ€í•œë¯¼êµ­ì˜ ìˆ˜ë„ëŠ”?",
        choices: ["ë¶€ì‚°", "ì„œìš¸", "ëŒ€êµ¬", "ì¸ì²œ"],
        answer: "ì„œìš¸"
      },
      {
        question: "3 + 4 = ?",
        choices: ["5", "6", "7", "8"],
        answer: "7"
      },
      {
        question: "HTMLì˜ ì•½ìëŠ”?",
        choices: ["HyperText Markup Language", "Hyperlink Machine Logic", "HighText Machine Language", "None"],
        answer: "HyperText Markup Language"
      }
    ];

    let questions = [];

    function shuffleArray(arr) {
      return arr.map(v => [Math.random(), v])
                .sort((a, b) => a[0] - b[0])
                .map(v => v[1]);
    }

    function shuffleAndRender() {
      questions = shuffleArray(originalQuestions);
      const quizDiv = document.getElementById("quiz");
      quizDiv.innerHTML = "";

      questions.forEach((q, i) => {
        const div = document.createElement("div");
        div.className = "question";
        div.innerHTML = `<strong>${i + 1}. ${q.question}</strong><br>` +
          q.choices.map(choice => `
            <label>
              <input type="radio" name="q${i}" value="${choice}"> ${choice}
            </label><br>`).join("");
        quizDiv.appendChild(div);
      });

      document.getElementById("result").innerText = "";
    }

    function grade() {
      let score = 0;
      let wrongs = [];
      let unanswered = [];

      questions.forEach((q, i) => {
        const selected = document.querySelector(`input[name=q${i}]:checked`);
        if (!selected) {
          unanswered.push(i + 1); // ë¬¸ì œ ë²ˆí˜¸ (1ë¶€í„° ì‹œì‘)
        } else if (selected.value === q.answer) {
          score++;
        } else {
          wrongs.push(`${i + 1}. ${q.question} â†’ ì •ë‹µ: ${q.answer}`);
        }
      });

      const result = document.getElementById("result");

      if (unanswered.length > 0) {
        result.innerHTML = `
          âš ï¸ ì•„ë˜ ë¬¸ì œì— ë‹µì„ ì„ íƒí•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤:<br>
          ${unanswered.join(', ')}ë²ˆ ë¬¸ì œ<br>
          <strong>ëª¨ë“  ë¬¸ì œë¥¼ ì„ íƒí•œ í›„ ë‹¤ì‹œ ì±„ì í•´ì£¼ì„¸ìš”.</strong>
        `;
        return;
      }

      result.innerHTML = `âœ… ì±„ì  ê²°ê³¼: ${score} / ${questions.length}ì <br>`;
      if (wrongs.length > 0) {
        result.innerHTML += `<br>âŒ í‹€ë¦° ë¬¸ì œ:<br><ul>${wrongs.map(q => `<li>${q}</li>`).join('')}</ul>`;
      }
    }

    window.onload = shuffleAndRender;
  </script>
</body>
</html>
