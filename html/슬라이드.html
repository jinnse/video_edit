<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ìŠ¬ë¼ì´ë“œí˜• CBT</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: auto;
      padding: 2rem;
    }
    .question {
      margin-bottom: 1.5rem;
    }
    .choice {
      margin-left: 1rem;
    }
    .button-bar {
      margin-top: 1rem;
      display: flex;
      justify-content: space-between;
    }
    .button-bar button {
      padding: 0.5rem 1rem;
      font-size: 1rem;
      cursor: pointer;
    }
    #result {
      margin-top: 2rem;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>ğŸ§  ìŠ¬ë¼ì´ë“œí˜• CBT</h1>

  <div id="quiz"></div>

  <div class="button-bar">
    <button onclick="prevQuestion()" id="prevBtn">â—€ ì´ì „ ë¬¸ì œ</button>
    <button onclick="grade()" id="gradeBtn" style="display: none;">âœ… ì±„ì í•˜ê¸°</button>
  </div>

  <div id="result"></div>

  <script>
    const originalQuestions = [
      {
        question: "ëŒ€í•œë¯¼êµ­ì˜ ìˆ˜ë„ëŠ”?",
        choices: ["ë¶€ì‚°", "ì„œìš¸", "ì¸ì²œ", "ëŒ€êµ¬"],
        answer: "ì„œìš¸"
      },
      {
        question: "3 + 5ëŠ”?",
        choices: ["6", "7", "8", "9"],
        answer: "8"
      },
      {
        question: "HTMLì˜ ì•½ìëŠ”?",
        choices: ["HyperText Markup Language", "HighText Machine Language", "Hyperlink Logic", "None"],
        answer: "HyperText Markup Language"
      }
    ];

    let questions = [];
    let current = 0;
    let userAnswers = [];

    function shuffleArray(arr) {
      return arr.map(v => [Math.random(), v])
                .sort((a, b) => a[0] - b[0])
                .map(v => v[1]);
    }

    function startQuiz() {
      questions = shuffleArray(originalQuestions);
      current = 0;
      userAnswers = new Array(questions.length).fill(null);
      document.getElementById("result").innerHTML = "";
      showQuestion();
    }

    function showQuestion() {
      const q = questions[current];
      const quizDiv = document.getElementById("quiz");

      quizDiv.innerHTML = `
        <div class="question">
          <strong>${current + 1}. ${q.question}</strong><br>
          ${q.choices.map(choice => `
            <label>
              <input type="radio" name="q" value="${choice}"
              ${userAnswers[current] === choice ? "checked" : ""}
              onclick="selectAnswer('${choice}')"> ${choice}
            </label><br>`).join("")}
        </div>
      `;

      // ì´ì „ ë²„íŠ¼ ìƒíƒœ ì„¤ì •
      document.getElementById("prevBtn").disabled = current === 0;

      // ë§ˆì§€ë§‰ ë¬¸ì œì´ë©´ ì±„ì  ë²„íŠ¼ ë³´ì´ê¸°, ì•„ë‹ˆë©´ ìˆ¨ê¸°ê¸°
      const gradeBtn = document.getElementById("gradeBtn");
      gradeBtn.style.display = (current === questions.length - 1) ? "inline-block" : "none";
    }

    function selectAnswer(choice) {
      userAnswers[current] = choice;

      // ë§ˆì§€ë§‰ ë¬¸ì œë©´ ë‹¤ìŒìœ¼ë¡œ ì•ˆ ë„˜ì–´ê°, ì±„ì  ë²„íŠ¼ë§Œ í‘œì‹œ
      if (current < questions.length - 1) {
        current++;
        showQuestion();
      }
    }

    function prevQuestion() {
      if (current > 0) {
        current--;
        showQuestion();
      }
    }

    function grade() {
      let score = 0;
      let wrongs = [];

      questions.forEach((q, i) => {
        if (userAnswers[i] === q.answer) {
          score++;
        } else {
          wrongs.push(`${i + 1}. ${q.question} â†’ ì •ë‹µ: ${q.answer}`);
        }
      });

      const result = document.getElementById("result");
      result.innerHTML = `
        âœ… ì±„ì  ê²°ê³¼: ${score} / ${questions.length}ì <br>
        ${wrongs.length > 0 ? `
          <br>âŒ í‹€ë¦° ë¬¸ì œ:<br><ul>
            ${wrongs.map(w => `<li>${w}</li>`).join("")}
          </ul>` : `<br>ğŸ‰ ëª¨ë“  ë¬¸ì œë¥¼ ë§ì·„ì–´ìš”!`}
        <br><br><button onclick="startQuiz()">ğŸ”„ ë‹¤ì‹œ í’€ê¸°</button>
      `;
      document.getElementById("quiz").innerHTML = "";
      document.getElementById("gradeBtn").style.display = "none";
      document.getElementById("prevBtn").disabled = true;
    }

    window.onload = startQuiz;
  </script>
</body>
</html>
